basePath: /
definitions:
  models.AddPlanToHistoryRequest:
    description: Request payload for adding a plan to the authenticated user's history
    properties:
      description:
        description: Description of the plan
        example: A comprehensive training plan for improving freestyle technique
        type: string
      plan_id:
        description: PlanID identifies the plan to add to history
        example: plan_123
        type: string
      table:
        description: A structured training plan table containing exercise rows
        items:
          $ref: '#/definitions/models.Row'
        type: array
      title:
        description: Title of the plan
        example: Advanced Freestyle Training
        type: string
    required:
    - description
    - plan_id
    - table
    - title
    type: object
  models.AddPlanToHistoryResponse:
    description: Response containing the new plan ID and a success message
    properties:
      message:
        example: Plan added to history successfully
        type: string
      plan_id:
        example: plan_123
        type: string
    type: object
  models.ChatRequest:
    description: Request payload for conversational training plan creation and refinement
    properties:
      language:
        allOf:
        - $ref: '#/definitions/models.Language'
        description: Language specifies the language for the response
        example: en
      message:
        description: Message is the user's input to the chat
        example: Make it more challenging
        type: string
      plan_id:
        description: PlanID identifies the conversation/plan (optional for new conversations)
        example: plan_123
        type: string
      pool_length:
        description: PoolLength specifies the pool length for the training plan
    required:
    - message
    type: object
  models.ChatResponsePayload:
    description: Response containing the updated plan and conversational response
    properties:
      description:
        description: Description of the training plan
        example: A comprehensive training plan for improving freestyle technique
        type: string
      plan_id:
        description: PlanID identifies the conversation/plan
        example: plan_123
        type: string
      response:
        description: Response is the conversational AI response explaining changes
        example: I've made the plan more challenging by adding butterfly sets
        type: string
      table:
        description: A structured training plan table containing exercise rows
        items:
          $ref: '#/definitions/models.Row'
        type: array
      title:
        description: Title of the training plan
        example: Advanced Freestyle Training
        type: string
    type: object
  models.DeleteConversationRequest:
    description: Request payload for deleting an entire conversation and all its messages
    properties:
      plan_id:
        description: PlanID identifies the conversation to delete
        example: plan_123
        type: string
    required:
    - plan_id
    type: object
  models.DeleteMessageRequest:
    description: Request payload for deleting a single message from conversation history
    properties:
      message_id:
        description: MessageID identifies the message to delete
        example: msg_123
        type: string
    required:
    - message_id
    type: object
  models.DeleteMessagesAfterRequest:
    description: Request payload for deleting a message and all subsequent messages
      in the conversation
    properties:
      message_id:
        description: MessageID identifies the message from which to delete (inclusive)
        example: msg_123
        type: string
    required:
    - message_id
    type: object
  models.DonatedPlan:
    properties:
      allow_sharing:
        description: AllowSharing indicates if the plan can be used in the RAG system
        type: boolean
      created_at:
        description: CreatedAt is the time the plan was donated as a datetime string
        type: string
      description:
        type: string
      plan_id:
        type: string
      table:
        description: Table is the table associated with the plan
        items:
          $ref: '#/definitions/models.Row'
        type: array
      title:
        type: string
      user_id:
        type: string
    type: object
  models.FeedbackRequest:
    description: Request payload for submitting feedback on a training plan
    properties:
      comment:
        example: Great plan!
        type: string
      difficulty_rating:
        example: 7
        maximum: 10
        minimum: 1
        type: integer
      plan_id:
        example: plan_123
        type: string
      rating:
        example: 5
        maximum: 5
        minimum: 1
        type: integer
      was_swam:
        example: true
        type: boolean
    required:
    - plan_id
    - rating
    type: object
  models.GeneratePromptRequest:
    description: Request payload for generating a prompt for swim training plan creation
    properties:
      language:
        allOf:
        - $ref: '#/definitions/models.Language'
        example: en
    required:
    - language
    type: object
  models.GeneratedPromptResponse:
    description: Response containing the generated prompt for swim training plan creation
    properties:
      prompt:
        example: Generate a swim training plan for improving freestyle technique
        type: string
    type: object
  models.HealthStatus:
    description: Health status of the service and its components
    properties:
      components:
        additionalProperties:
          type: string
        type: object
      schema_version:
        type: integer
      status:
        type: string
      timestamp:
        type: string
    type: object
  models.Language:
    enum:
    - en
    - de
    type: string
    x-enum-varnames:
    - LanguageEN
    - LanguageDE
  models.MessagePayload:
    description: Snapshot of a training plan
    properties:
      content:
        type: string
      created_at:
        description: Table containing the training plan details
        type: string
      id:
        type: string
      next_message_id:
        type: string
      plan_id:
        type: string
      plan_snapshot:
        $ref: '#/definitions/models.RAGResponse'
      previous_message_id:
        type: string
      role:
        $ref: '#/definitions/models.Role'
      user_id:
        type: string
    type: object
  models.PlanToPDFRequest:
    description: Request payload for exporting a training plan to PDF format
    properties:
      description:
        example: A comprehensive training plan for improving freestyle technique
        type: string
      horizontal:
        description: Horizontal indicates if the PDF should be in landscape orientation
        example: false
        type: boolean
      language:
        allOf:
        - $ref: '#/definitions/models.Language'
        description: Language specifies the language for the PDF content
        example: en
      large_font:
        description: LargeFont indicates if the PDF should use a larger font size
        example: true
        type: boolean
      plan_id:
        description: PlanID identifies the training plan to be exported
        example: plan_123
        type: string
      table:
        description: A structured training plan table containing exercise rows
        items:
          $ref: '#/definitions/models.Row'
        type: array
      title:
        example: Advanced Freestyle Training
        type: string
    required:
    - description
    - table
    - title
    type: object
  models.PlanToPDFResponse:
    description: Response containing the URI to the generated PDF file
    properties:
      uri:
        example: https://storage.googleapis.com/bucket/plans/plan_123.pdf
        type: string
    type: object
  models.QueryRequest:
    description: Request payload for querying swim training plans from the RAG system
    properties:
      content:
        description: Content describes what kind of training plan is needed
        example: I need a training plan for improving my freestyle technique
        type: string
      filter:
        additionalProperties: {}
        description: Filter allows filtering plans by metadata like difficulty or
          stroke type
        type: object
      language:
        allOf:
        - $ref: '#/definitions/models.Language'
        description: Language specifies the language for the response
        example: en
      method:
        description: Method can be either 'choose' (select existing plan) or 'generate'
          (create new plan)
        enum:
        - choose
        - generate
        example: generate
        type: string
      pool_length:
        description: PoolLength specifies the pool length for the training plan
    required:
    - content
    - method
    type: object
  models.RAGResponse:
    description: Response containing a generated or selected swim training plan
    properties:
      description:
        example: A comprehensive training plan for improving freestyle technique
        type: string
      plan_id:
        description: PlanID is the identifier of the training plan
        example: plan_123
        type: string
      table:
        description: A structured training plan table containing exercise rows
        items:
          $ref: '#/definitions/models.Row'
        type: array
      title:
        example: Advanced Freestyle Training
        type: string
    type: object
  models.Role:
    enum:
    - user
    - ai
    type: string
    x-enum-varnames:
    - RoleUser
    - RoleAI
  models.Row:
    description: A single exercise entry with amount, distance, breaks, content, intensity
      and total volume
    properties:
      Amount:
        example: 4
        type: integer
      Break:
        example: "20"
        type: string
      Content:
        example: Freestyle swim
        type: string
      Distance:
        example: 100
        type: integer
      Intensity:
        example: Easy
        type: string
      Multiplier:
        example: x
        type: string
      Sum:
        example: 400
        type: integer
    type: object
  models.SharePlanRequest:
    description: Request payload for sharing a swim training plan
    properties:
      method:
        allOf:
        - $ref: '#/definitions/models.SharingMethod'
        description: Method specifies the sharing method, e.g., 'link' or 'email'
        example: link
      plan_id:
        description: PlanID identifies the training plan to be shared
        example: plan_123
        type: string
    required:
    - method
    - plan_id
    type: object
  models.SharePlanResponse:
    description: Response containing the sharing details of the swim training plan
    properties:
      url_hash:
        description: URLHash is the hash to access the shared training plan
        example: abc123
        type: string
    type: object
  models.SharingMethod:
    enum:
    - link
    - email
    type: string
    x-enum-varnames:
    - SharingMethodLink
    - SharingMethodEmail
  models.UploadPlanRequest:
    description: Request payload for donating a swim training plan to the system
    properties:
      allow_sharing:
        description: AllowSharing indicates if the plan can be shared with others
        type: boolean
      description:
        example: A comprehensive training plan for improving freestyle technique
        type: string
      language:
        allOf:
        - $ref: '#/definitions/models.Language'
        description: Language specifies the language of the training plan
        example: en
      table:
        description: A structured training plan table containing exercise rows
        items:
          $ref: '#/definitions/models.Row'
        type: array
      title:
        example: Advanced Freestyle Training
        type: string
    required:
    - table
    type: object
  models.UpsertPlanRequest:
    description: Request payload for upserting a swim training plan to the system
    properties:
      description:
        example: A comprehensive training plan for improving freestyle technique
        type: string
      plan_id:
        description: PlanID identifies the training plan to be upserted
        example: plan_123
        type: string
      table:
        description: A structured training plan table containing exercise rows
        items:
          $ref: '#/definitions/models.Row'
        type: array
      title:
        example: Advanced Freestyle Training
        type: string
    required:
    - description
    - table
    - title
    type: object
  models.UpsertPlanResponse:
    description: Response containing the upserted swim training plan
    properties:
      plan_id:
        example: plan_123
        type: string
    type: object
externalDocs:
  description: OpenAPI
  url: https://swagger.io/resources/open-api/
info:
  contact: {}
  description: A REST API for swim training plan management with RAG capabilities
  license:
    name: Apache 2.0
    url: http://www.apache.org/licenses/LICENSE-2.0.html
  title: Swim Gen API
  version: "1.0"
paths:
  /add:
    post:
      consumes:
      - application/json
      description: Upload and store a new user created swim training plan in the database
      parameters:
      - description: Training plan data
        in: body
        name: plan
        required: true
        schema:
          $ref: '#/definitions/models.UploadPlanRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Plan added successfully
          schema:
            type: string
        "400":
          description: Bad request
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: Upload a new private training plan
      tags:
      - Upload
  /add-plan-to-history:
    post:
      consumes:
      - application/json
      description: Add a plan to the authenticated user's history with a new id
      parameters:
      - description: Plan to add to history
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.AddPlanToHistoryRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.AddPlanToHistoryResponse'
        "400":
          description: Bad request
          schema:
            type: string
        "401":
          description: Unauthorized
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Add a plan to user history
      tags:
      - Training Plans
  /chat:
    post:
      consumes:
      - application/json
      description: Have a conversation with the AI trainer to create, modify, or get
        information about training plans
      parameters:
      - description: Chat request with message and optional plan ID
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.ChatRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Successful chat response with updated plan
          schema:
            $ref: '#/definitions/models.ChatResponsePayload'
        "400":
          description: Bad request
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: Chat with AI to create or refine training plans
      tags:
      - Chat
  /export-pdf:
    post:
      consumes:
      - application/json
      description: Generate and download a PDF version of a training plan
      parameters:
      - description: Training plan data to export
        in: body
        name: plan
        required: true
        schema:
          $ref: '#/definitions/models.PlanToPDFRequest'
      produces:
      - application/json
      responses:
        "200":
          description: PDF export response with URI
          schema:
            $ref: '#/definitions/models.PlanToPDFResponse'
        "400":
          description: Bad request
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: Export training plan to PDF
      tags:
      - Training Plans
  /feedback:
    post:
      consumes:
      - application/json
      description: Submit a rating, was_swam status, and difficulty rating for a training
        plan
      parameters:
      - description: Feedback data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.FeedbackRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Feedback submitted successfully
          schema:
            type: string
        "400":
          description: Bad request
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: Submit feedback for a training plan
      tags:
      - Feedback
  /file-to-plan:
    post:
      consumes:
      - multipart/form-data
      description: Convert a file containing a training plan to a structured plan.
        Supports PNG, JPEG, and PDF formats.
      parameters:
      - description: File containing a plan (PNG, JPEG, or PDF)
        in: formData
        name: image
        required: true
        type: file
      produces:
      - application/json
      responses:
        "200":
          description: Plan ID of the converted plan
          schema:
            $ref: '#/definitions/models.RAGResponse'
        "400":
          description: Bad request or unsupported file type
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: Convert a file (image or PDF) of a plan to a plan
      tags:
      - Upload
  /generate-prompt:
    post:
      consumes:
      - application/json
      description: Generate a prompt for the LLM based on the provided language
      parameters:
      - description: Request to generate a prompt
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.GeneratePromptRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Generated prompt response
          schema:
            $ref: '#/definitions/models.GeneratedPromptResponse'
        "400":
          description: Bad request
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Generate a prompt for the LLM
      tags:
      - Training Plans
  /health:
    get:
      description: Returns the health status of the API including database and vector
        store connectivity
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.HealthStatus'
        "503":
          description: Service Unavailable
          schema:
            $ref: '#/definitions/models.HealthStatus'
      summary: Comprehensive health check
      tags:
      - Health
  /health-basic:
    get:
      description: Returns a simple OK response for basic health monitoring
      produces:
      - text/plain
      responses:
        "200":
          description: OK
          schema:
            type: string
      summary: Basic health check
      tags:
      - Health
  /memory/conversation:
    delete:
      consumes:
      - application/json
      description: Delete all messages in a conversation for a specific plan
      parameters:
      - description: Request to delete a conversation
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.DeleteConversationRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Conversation deleted successfully
          schema:
            type: string
        "400":
          description: Bad request
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: Delete an entire conversation
      tags:
      - Memory
    get:
      consumes:
      - application/json
      description: Get the full conversation history for a specific plan
      parameters:
      - description: Plan ID
        in: query
        name: plan_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Conversation history
          schema:
            items:
              $ref: '#/definitions/models.MessagePayload'
            type: array
        "400":
          description: Bad request
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: Get conversation history
      tags:
      - Memory
  /memory/message:
    delete:
      consumes:
      - application/json
      description: Delete a specific message from the conversation history while maintaining
        the linked list integrity
      parameters:
      - description: Request to delete a message
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.DeleteMessageRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Message deleted successfully
          schema:
            type: string
        "400":
          description: Bad request
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: Delete a single message from conversation
      tags:
      - Memory
  /memory/messages-after:
    delete:
      consumes:
      - application/json
      description: Delete a message and all messages that follow it in the conversation,
        allowing conversation branching
      parameters:
      - description: Request to delete messages from a point
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.DeleteMessagesAfterRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Messages deleted successfully
          schema:
            type: string
        "400":
          description: Bad request
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: Delete a message and all subsequent messages
      tags:
      - Memory
  /plan/{plan_id}:
    delete:
      consumes:
      - application/json
      description: Delete a training plan from the authenticated user's history and
        remove all associated data
      parameters:
      - description: Plan ID to delete
        in: path
        name: plan_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Plan deleted successfully
          schema:
            type: string
        "400":
          description: Bad request
          schema:
            type: string
        "401":
          description: Unauthorized
          schema:
            type: string
        "404":
          description: Plan not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: Delete a training plan
      tags:
      - Training Plans
  /query:
    post:
      consumes:
      - application/json
      description: Query the RAG system for relevant training plans based on input
      parameters:
      - description: Query parameters
        in: body
        name: query
        required: true
        schema:
          $ref: '#/definitions/models.QueryRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Query results
          schema:
            $ref: '#/definitions/models.RAGResponse'
        "400":
          description: Bad request
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: Query training plans
      tags:
      - Training Plans
  /scrape:
    get:
      description: Scrape and import training plans from external websites
      parameters:
      - description: URL to scrape training plans from
        in: query
        name: url
        required: true
        type: string
      produces:
      - text/plain
      responses:
        "200":
          description: Scraping completed successfully
          schema:
            type: string
        "400":
          description: Bad request - Missing url parameter
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      summary: Scrape training plans from web
      tags:
      - Web Scraping
  /share-plan:
    post:
      consumes:
      - application/json
      description: Share a training plan via link or email. Email sharing is not implemented
        yet.
      parameters:
      - description: Request to share a training plan
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.SharePlanRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Share plan response with URI
          schema:
            $ref: '#/definitions/models.SharePlanResponse'
        "400":
          description: Bad request
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: Share a training plan
      tags:
      - Training Plans
  /uploads:
    get:
      consumes:
      - application/json
      description: Get all plans uploaded by the authenticated user
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/models.DonatedPlan'
            type: array
        "401":
          description: Unauthorized
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: Get uploaded plans
      tags:
      - Upload
  /uploads/{plan_id}:
    get:
      consumes:
      - application/json
      description: Get a specific plan uploaded by the authenticated user
      parameters:
      - description: Plan ID
        in: path
        name: plan_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.DonatedPlan'
        "401":
          description: Unauthorized
          schema:
            type: string
        "404":
          description: Plan not found
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: Get a uploaded plan
      tags:
      - Upload
  /upsert-plan:
    post:
      consumes:
      - application/json
      description: Update an existing training plan if it belongs to the user, or
        insert a new one
      parameters:
      - description: Request to upsert a training plan
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.UpsertPlanRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Plan ID of the upserted training plan
          schema:
            $ref: '#/definitions/models.UpsertPlanResponse'
        "400":
          description: Bad request
          schema:
            type: string
        "500":
          description: Internal server error
          schema:
            type: string
      security:
      - BearerAuth: []
      summary: Update or insert a training plan into a user's history
      tags:
      - Training Plans
securityDefinitions:
  BearerAuth:
    description: Type "Bearer" followed by a space and the JWT.
    in: header
    name: Authorization
    type: apiKey
swagger: "2.0"
